{% extends "layout.html" %}
{% block body %}



<head>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
  integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
  integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

  <script>
    var x = document.getElementById("demo");

    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        x.innerHTML = "Geolocation is not supported by this browser.";
      }
    }

    function showPosition(position) {
      x.innerHTML = "Latitude: " + position.coords.latitude +
        "<br>Longitude: " + position.coords.longitude;
    }
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
  <style>
    #map {
      height: 180px;
    }

    .card {
      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
      max-width: 500px;
      margin: auto;
      text-align: center;
      font-family: arial;
      align-items: center;
    }

    .title {
      color: grey;
      font-size: 18px;
    }

    button {
      border: none;
      outline: 0;
      display: inline-block;
      padding: 8px;
      color: white;
      background-color: #000;
      text-align: center;
      cursor: pointer;
      width: 100%;
      font-size: 18px;
    }

    .sbutton {
      background-color: #ffffff;
      /* Green */
      border: 2px solid #4CAF50;
      color: rgb(0, 0, 0);
      padding: 16px 32px;
      text-align: left;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      transition-duration: 0.4s;
      cursor: pointer;
      width: 100%;
      border-radius: 10px;
    }

    a {
      text-decoration: none;
      font-size: 22px;
      color: black;
    }

    button:hover,
    a:hover {
      opacity: 0.7;
    }

    .sbutton:hover {
      background-color: #4CAF50;
      color: white;
    }
  </style>
</head>

<body>
  <div>
    {% if user == shop.staff %}
    <h2 style="text-align:center">My Shop</h2>
    {% endif %}

    <div class="card">

      <img src="{{ shop.shopimg.url }}" alt="shopimg" width="200px">
      <h1> {{ shop.name }}</h1>
      <p class="title">bio: {{ shop.detail }}</p>















      <div id="map" style="width:400px; height: 400px;"></div>

      <!-- define a the area the map will go into. Feel free to change the size as needed -->
      <!-- <div id="map" style="width:400px; height: 300px;"></div>
      <script>

        var coords = [37.69, -59.23]; // the geographic center of our map
        var zoomLevel = 2; // the map scale. See: http://wiki.openstreetmap.org/wiki/Zoom_levels

        var map = L.map('map').setView(coords, zoomLevel);

        // we need to provide the map with some base map tiles. There are few free options.
        // we'll use Stamen Acetate, a muted base map good for overlaying data.
        var tiles = 'http://acetate.geoiq.com/tiles/acetate-hillshading/';
        // if you'd like to explore other base maps, see: http://developer.mapquest.com/web/products/open/map

        // if you use different tiles, be sure to update the attribution :)
        L.tileLayer(tiles + '{z}/{x}/{y}.png', {
          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery &copy; <a href="http://FortiusOne.com">FortiusOne</a> and <a href="http://stamen.com">Stamen</a>',
          maxZoom: 18
        }).addTo(map);
      </script> -->


      <div id="map">
        <a href="https://www.maptiler.com" style="position:absolute;left:10px;bottom:10px;z-index:999;"><img src="https://api.maptiler.com/resources/logo.svg" alt="MapTiler logo"></a>
      </div>
      <script>
        const key = '7fp1Wm4VWG2FYaeZticr';
        let text = "{{ shop.location }}";
        const myArray = text.split(",");
        let lat = myArray[0];
        let lon = myArray[1];

        // const x = $('#shop.location[0]')
        // const y = $('#shop.location[1]')
        // const map = L.map('map').setView([13.75864, 100.4908], 50); //starting position
        const map = L.map('map').setView([lat, lon],20); //starting position
        L.tileLayer(`https://api.maptiler.com/maps/streets/{z}/{x}/{y}.png?key=${key}`,{ //style URL
          tileSize: 512,
          zoomOffset: -1,
          minZoom: 1,
          
          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery &copy; <a href="http://FortiusOne.com">FortiusOne</a> and <a href="http://stamen.com">Stamen</a>',
          maxZoom: 18
        }).addTo(map);
      </script>

      {{ shop.location }}



















      <div style="margin: 24px 0;">

      </div>
      {% if user == shop.staff %}
      <button><a style="color: white" href="{% url 'modifyshop' %}">Modify Shop</a></button>
      {% elif not user.is_staff %}
      <div style="margin: 24px 0;">
        <a class="fix" href="{% url 'shopcheckview' shop.name %}"><i class="far fa-comments"
            style='font-size:40px'></i></a>
        {% endif %}
      </div>
      <br>
      {% if user.is_superuser %}
      {% for chat in chats %}
      <a href="{% url 'join_chat' chat.name %}" class="sbutton button1">
        <p>Username: {{ chat.customer }}</p>
      </a>
      {% endfor %}
      {% endif %}
    </div>
  </div>
</body>
{% endblock %}